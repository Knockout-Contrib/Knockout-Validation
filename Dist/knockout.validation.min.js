(function(n){typeof require=="function"&&typeof exports=="object"&&typeof module=="object"?n(require("knockout"),exports):typeof define=="function"&&define.amd?define(["knockout","exports"],n):n(ko,ko.validation={})})(function(n,t){function e(t,i,r){return i.validator(t(),r.params===undefined?!0:r.params)?!0:(t.error(n.validation.formatMessage(r.message||i.message,r.params)),t.__valid__(!1),!1)}function o(t,i,r){t.isValidating(!0);var u=function(u){var f=!1,e="";if(!t.__valid__()){t.isValidating(!1);return}u.message?(f=u.isValid,e=u.message):f=u;f||(t.error(n.validation.formatMessage(e||r.message||i.message,r.params)),t.__valid__(f));t.isValidating(!1)};i.validator(t(),r.params||!0,u)}var r,i,u,f;if(typeof n===undefined)throw"Knockout is required, please ensure it is loaded before loading this validation plug-in";n.validation=t;r={registerExtenders:!0,messagesOnModified:!0,errorsAsTitle:!0,errorsAsTitleOnModified:!1,messageTemplate:null,insertMessages:!0,parseInputAttributes:!1,writeInputAttributes:!1,decorateElement:!1,decorateElementOnModified:!0,errorClass:null,errorElementClass:"validationElement",errorMessageClass:"validationMessage",grouping:{deep:!1,observable:!0}};i=n.utils.extend({},r);i.html5Attributes=["required","pattern","min","max","step"];i.html5InputTypes=["email","number","date"];i.reset=function(){n.utils.extend(i,r)};n.validation.configuration=i;n.validation.utils=function(){var r=(new Date).getTime(),i={},t="__ko_validation__";return{isArray:function(n){return n.isArray||Object.prototype.toString.call(n)==="[object Array]"},isObject:function(n){return n!==null&&typeof n=="object"},values:function(n){var i=[],t;for(t in n)n.hasOwnProperty(t)&&i.push(n[t]);return i},getValue:function(n){return typeof n=="function"?n():n},hasAttribute:function(n,t){return n.getAttribute(t)!==null},getAttribute:function(n,t){return n.getAttribute(t)},setAttribute:function(n,t,i){return n.setAttribute(t,i)},isValidatable:function(n){return n&&n.rules&&n.isValid&&n.isModified},insertAfter:function(n,t){n.parentNode.insertBefore(t,n.nextSibling)},newId:function(){return r+=1},getConfigOptions:function(t){var i=n.validation.utils.contextFor(t);return i||n.validation.configuration},setDomData:function(r,u){var f=r[t];f||(r[t]=f=n.validation.utils.newId());i[f]=u},getDomData:function(n){var r=n[t];return r?i[r]:undefined},contextFor:function(t){switch(t.nodeType){case 1:case 8:var i=n.validation.utils.getDomData(t);if(i)return i;if(t.parentNode)return n.validation.utils.contextFor(t.parentNode)}return undefined},isEmptyVal:function(n){return n===undefined?!0:n===null?!0:n===""?!0:void 0},getOriginalElementTitle:function(t){var i=n.validation.utils.getAttribute(t,"data-orig-title"),r=t.title,u=n.validation.utils.hasAttribute(t,"data-orig-title");return u?i:r},async:function(n){window.setImmediate?window.setImmediate(n):window.setTimeout(n,0)}}}();u=function(){var r=0,i=n.validation.configuration,t=n.validation.utils;return{init:function(t,u){r>0&&!u||(t=t||{},t.errorElementClass=t.errorElementClass||t.errorClass||i.errorElementClass,t.errorMessageClass=t.errorMessageClass||t.errorClass||i.errorMessageClass,n.utils.extend(i,t),i.registerExtenders&&n.validation.registerExtenders(),r=1)},configure:function(t){n.validation.init(t)},reset:n.validation.configuration.reset,group:function(r,u){u=n.utils.extend(n.utils.extend({},i.grouping),u);var e=n.observableArray([]),f=null,o=function o(i,r){var s=[],f=n.utils.unwrapObservable(i);r=r!==undefined?r:u.deep?1:-1;n.isObservable(i)&&(i.isValid||i.extend({validatable:!0}),e.push(i));f&&(t.isArray(f)?s=f:t.isObject(f)&&(s=t.values(f)));r!==0&&n.utils.arrayForEach(s,function(n){n&&!n.nodeType&&o(n,r+1)})};return u.observable?(o(r),f=n.computed(function(){var t=[];return n.utils.arrayForEach(e(),function(n){n.isValid()||t.push(n.error)}),t})):f=function(){var t=[];return e([]),o(r),n.utils.arrayForEach(e(),function(n){n.isValid()||t.push(n.error)}),t},f.showAllMessages=function(t){t===undefined&&(t=!0);f();n.utils.arrayForEach(e(),function(n){n.isModified(t)})},r.errors=f,r.isValid=function(){return r.errors().length===0},r.isAnyMessageShown=function(){var t=!1;return f(),n.utils.arrayForEach(e(),function(n){!n.isValid()&&n.isModified()&&(t=!0)}),t},f},formatMessage:function(t,i){return typeof t=="function"?t(i):t.replace(/\{0\}/gi,n.utils.unwrapObservable(i))},addRule:function(n,t){return n.extend({validatable:!0}),n.rules.push(t),n},addAnonymousRule:function(i,r){var u=t.newId();r.message===undefined&&(r.message="Error");n.validation.rules[u]=r;n.validation.addRule(i,{rule:u,params:r.params})},addExtender:function(i){n.extenders[i]=function(r,u){return u.message||u.onlyIf?n.validation.addRule(r,{rule:i,message:u.message,params:t.isEmptyVal(u.params)?!0:u.params,condition:u.onlyIf}):n.validation.addRule(r,{rule:i,params:u})}},registerExtenders:function(){if(i.registerExtenders)for(var t in n.validation.rules)n.validation.rules.hasOwnProperty(t)&&(n.extenders[t]||n.validation.addExtender(t))},insertValidationMessage:function(n){var i=document.createElement("SPAN");return i.className=t.getConfigOptions(n).errorMessageClass,t.insertAfter(n,i),i},parseInputValidationAttributes:function(i,r){n.utils.arrayForEach(n.validation.configuration.html5Attributes,function(u){t.hasAttribute(i,u)&&n.validation.addRule(r(),{rule:u,params:i.getAttribute(u)||!0})});var u=i.getAttribute("type");n.utils.arrayForEach(n.validation.configuration.html5InputTypes,function(t){t===u&&n.validation.addRule(r(),{rule:t==="date"?"dateISO":t,params:!0})})},writeInputValidationAttributes:function(t,i){var r=i(),u;r&&r.rules&&(u=r.rules(),n.utils.arrayForEach(n.validation.configuration.html5Attributes,function(i){var f,r=n.utils.arrayFirst(u,function(n){return n.rule.toLowerCase()===i.toLowerCase()});r&&(f=r.params,r.rule==="pattern"&&r.params instanceof RegExp&&(f=r.params.source),t.setAttribute(i,f))}),u=null)},makeBindingHandlerValidatable:function(t){var i=n.bindingHandlers[t].init;n.bindingHandlers[t].init=function(t,r,u,f,e){return i(t,r,u,f,e),n.bindingHandlers.validationCore.init(t,r,u,f,e)}}}}();n.utils.extend(n.validation,u);n.validation.rules={};n.validation.rules.required={validator:function(n,t){var i;return n===undefined||n===null?!t:(i=n,typeof n=="string"&&(i=n.replace(/^\s+|\s+$/g,"")),!t)?!0:(i+"").length>0},message:"This field is required."};n.validation.rules.min={validator:function(t,i){return n.validation.utils.isEmptyVal(t)||t>=i},message:"Please enter a value greater than or equal to {0}."};n.validation.rules.max={validator:function(t,i){return n.validation.utils.isEmptyVal(t)||t<=i},message:"Please enter a value less than or equal to {0}."};n.validation.rules.minLength={validator:function(t,i){return n.validation.utils.isEmptyVal(t)||t.length>=i},message:"Please enter at least {0} characters."};n.validation.rules.maxLength={validator:function(t,i){return n.validation.utils.isEmptyVal(t)||t.length<=i},message:"Please enter no more than {0} characters."};n.validation.rules.pattern={validator:function(t,i){return n.validation.utils.isEmptyVal(t)||t.toString().match(i)!==null},message:"Please check this value."};n.validation.rules.step={validator:function(t,i){if(n.validation.utils.isEmptyVal(t)||i==="any")return!0;var r=t*100%(i*100);return Math.abs(r)<1e-5||Math.abs(1-r)<1e-5},message:"The value must increment by {0}"};n.validation.rules.email={validator:function(t,i){return i?n.validation.utils.isEmptyVal(t)||i&&/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(t):!0},message:"Please enter a proper email address"};n.validation.rules.date={validator:function(t,i){return i?n.validation.utils.isEmptyVal(t)||i&&!/Invalid|NaN/.test(new Date(t)):!0},message:"Please enter a proper date"};n.validation.rules.dateISO={validator:function(t,i){return i?n.validation.utils.isEmptyVal(t)||i&&/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(t):!0},message:"Please enter a proper date"};n.validation.rules.number={validator:function(t,i){return i?n.validation.utils.isEmptyVal(t)||i&&/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(t):!0},message:"Please enter a number"};n.validation.rules.digit={validator:function(t,i){return i?n.validation.utils.isEmptyVal(t)||i&&/^\d+$/.test(t):!0},message:"Please enter a digit"};n.validation.rules.phoneUS={validator:function(t,i){return i?typeof t!="string"?!1:n.validation.utils.isEmptyVal(t)?!0:(t=t.replace(/\s+/g,""),i&&t.length>9&&t.match(/^(1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)):!0},message:"Please specify a valid phone number"};n.validation.rules.equal={validator:function(t,i){var r=i;return t===n.validation.utils.getValue(r)},message:"Values must equal"};n.validation.rules.notEqual={validator:function(t,i){var r=i;return t!==n.validation.utils.getValue(r)},message:"Please choose another value."};n.validation.rules.unique={validator:function(t,i){var r=n.validation.utils.getValue(i.collection),u=n.validation.utils.getValue(i.externalValue),f=0;return!t||!r?!0:(n.utils.arrayFilter(n.utils.unwrapObservable(r),function(n){t===(i.valueAccessor?i.valueAccessor(n):n)&&f++}),f<(u!==undefined&&t!==u?1:2))},message:"Please make sure the value is unique."},function(){n.validation.registerExtenders()}();n.bindingHandlers.validationCore=function(){return{init:function(t,i){var r=n.validation.utils.getConfigOptions(t),u;r.parseInputAttributes&&n.validation.utils.async(function(){n.validation.parseInputValidationAttributes(t,i)});r.insertMessages&&n.validation.utils.isValidatable(i())&&(u=n.validation.insertValidationMessage(t),r.messageTemplate?n.renderTemplate(r.messageTemplate,{field:i()},null,u,"replaceNode"):n.applyBindingsToNode(u,{validationMessage:i()}));r.writeInputAttributes&&n.validation.utils.isValidatable(i())&&n.validation.writeInputValidationAttributes(t,i);r.decorateElement&&n.validation.utils.isValidatable(i())&&n.applyBindingsToNode(t,{validationElement:i()})},update:function(){}}}();n.validation.makeBindingHandlerValidatable("value");n.validation.makeBindingHandlerValidatable("checked");n.bindingHandlers.validationMessage={update:function(t,i){var r=i(),e=n.validation.utils.getConfigOptions(t),h=n.utils.unwrapObservable(r),u=!1,f=!1,o,s;r.extend({validatable:!0});u=r.isModified();f=r.isValid();o=function(){return!e.messagesOnModified||u?f?null:r.error:null};s=function(){return!e.messagesOnModified||u?!f:!1};n.bindingHandlers.text.update(t,o);n.bindingHandlers.visible.update(t,s)}};n.bindingHandlers.validationElement={update:function(t,i){var r=i(),u=n.validation.utils.getConfigOptions(t),h=n.utils.unwrapObservable(r),f=!1,e=!1,o;if(r.extend({validatable:!0}),f=r.isModified(),e=r.isValid(),o=function(){var n={},t=!u.decorateElementOnModified||f?!e:!1;return u.decorateElement||(t=!1),n[u.errorElementClass]=t,n},n.bindingHandlers.css.update(t,o),u.errorsAsTitle){var c=n.validation.utils.getAttribute(t,"data-orig-title"),l=t.title,a=n.validation.utils.getAttribute(t,"data-orig-title")==="true",s=function(){if(!u.errorsAsTitleOnModified||f)return e?{title:n.validation.utils.getOriginalElementTitle(t),"data-orig-title":null}:{title:r.error,"data-orig-title":n.validation.utils.getOriginalElementTitle(t)}};n.bindingHandlers.attr.update(t,s)}}};n.bindingHandlers.validationOptions=function(){return{init:function(t,i){var u=n.utils.unwrapObservable(i()),r;u&&(r=n.utils.extend({},n.validation.configuration),n.utils.extend(r,u),n.validation.utils.setDomData(t,r))}}}();n.extenders.validation=function(t,i){return n.utils.arrayForEach(n.validation.utils.isArray(i)?i:[i],function(i){n.validation.addAnonymousRule(t,i)}),t};n.extenders.validatable=function(t,i){var r,u;return i&&!n.validation.utils.isValidatable(t)?(t.error=n.observable(null),t.rules=n.observableArray(),t.isValidating=n.observable(!1),t.__valid__=n.observable(!0),t.isModified=n.observable(!1),r=n.computed(function(){var i=t(),r=t.rules();return n.validation.validateObservable(t),!0}),t.isValid=n.computed(function(){return t.__valid__()}),t.setError=function(n){t.error(n);t.__valid__(!1)},t.clearError=function(){t.error(null);t.__valid__(!0)},u=t.subscribe(function(){t.isModified(!0)}),t._disposeValidation=function(){t.isValid.dispose();t.rules.removeAll();t.isModified._subscriptions.change=[];t.isValidating._subscriptions.change=[];t.__valid__._subscriptions.change=[];u.dispose();r.dispose();delete t.rules;delete t.error;delete t.isValid;delete t.isValidating;delete t.__valid__;delete t.isModified}):i===!1&&n.validation.utils.isValidatable(t)&&t._disposeValidation&&t._disposeValidation(),t};n.validation.validateObservable=function(t){for(var u=0,r,i,f=t.rules(),s=f.length;u<s;u++)if(i=f[u],!i.condition||i.condition())if(r=n.validation.rules[i.rule],r.async||i.async)o(t,r,i);else if(!e(t,r,i))return!1;return t.error(null),t.__valid__(!0),!0};n.validation.localize=function(t){var i;for(i in t)n.validation.rules.hasOwnProperty(i)&&(n.validation.rules[i].message=t[i])};n.applyBindingsWithValidation=function(t,i,r){var e=arguments.length,u,f;e>2?(u=i,f=r):e<2?u=document.body:arguments[1].nodeType?u=i:f=arguments[1];n.validation.init();f&&n.validation.utils.setDomData(u,f);n.applyBindings(t,i)};f=n.applyBindings;n.applyBindings=function(t,i){n.validation.init();f(t,i)};n.validatedObservable=function(t){if(!n.validation.utils.isObject(t))return n.observable(t).extend({validatable:!0});var i=n.observable(t);return i.errors=n.validation.group(t),i.isValid=n.computed(function(){return i.errors().length===0}),i}});
//# sourceMappingURL=knockout.validation.min.js.map